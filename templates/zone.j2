{#
    The following variables are available:

    - nameservers   (list of dns.name.Name, nameservers)
    - addresses     (list of IP Address, address records)
    - origin        (dns.name.Name, zone origin)
    - reverse_origin    (dns.name.Name, reverse zone origin)
    - serial        (zone serial)
    - refresh       (zone refresh)
    - retry         (zone retry)
    - expire        (zone expire)
    - ttl           (zone TTL)
    - timestamp
#}
{%- macro get_name(ip_address) -%}
{%- if ip_address.dns_name -%}
{{ ip_address.dns_name | fqdn | relativize }} {#- FIXME we just assume that 'dns_name' is qualified -#}
{%- else -%}
{%- if ip_address.assigned_object.device -%}
{{ ip_address.assigned_object.device.name | relativize }}
{%- elif ip_address.assigned_object.virtual_machine -%}
{{ ip_address.assigned_object.virtual_machine.name | relativize }}
{%- endif -%}
{%- endif -%}
{%- endmacro -%}

;; !! Do not edit manually !!
;; This file was generated by netbox-dns-zone at: {{ timestamp }}

$ORIGIN {{ origin }}
$TTL {{ ttl }}
{{ "%-39s" | format(origin | relativize) }} IN  SOA     {{ origin | relativize }} {{ "root" | relativize }} {{ serial }} {{ refresh }} {{ retry }} {{ expire }} {{ ttl }}
{{ "%-39s" | format(origin | relativize) }} IN  TXT     generated-by=netbox-dns-zone, generated-at={{ timestamp }}

{%- for nameserver in nameservers %}
{{ "%-39s" | format(origin | relativize) }} IN  NS      {{ nameserver | relativize }}
{%- endfor %}

{%- for ip_address in addresses %}
{{ "%-39s" | format(get_name(ip_address)) }} IN  {{ "%-7s" | format(ip_address | address_type ) }} {{ ip_address | address }}
{%- endfor %}
